{"version":3,"sources":["../../src/reducers/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import {basename, sep} from 'path'\n\nimport {\n  FOCUS_TAB,\n  FOCUS_PANEL,\n  RECEIVE_CALLSTACK,\n  RECEIVE_BREAKPOINTS,\n  CLEAR_SCOPE,\n  RECEIVE_SCOPE,\n  EXTEND_SCOPE,\n  SET_SCOPE_ITEM,\n  ADD_ITEM_TO_SCOPE,\n  RECEIVE_SOURCE,\n  RECEIVE_SOURCES,\n  SELECT_FILE,\n  SET_FILE_ITEM,\n  SET_EDITOR_LINE,\n  SELECT_FRAME,\n  PAUSE,\n  RESUME,\n  SET_DIMENSIONS,\n  TOGGLE_TOOLTIPS,\n  RECEIVE_STDOUT,\n  RECEIVE_STDERR,\n  CONSOLE_INPUT,\n  CONSOLE_HISTORY,\n  RECEIVE_EVAL_RESULT,\n  RECEIVE_EVAL_ERROR\n} from '../actions'\n\nconst CONSOLE_PREFIXES = {\n  [CONSOLE_INPUT]: '> ',\n  [RECEIVE_EVAL_RESULT]: '⦑ ',\n  [RECEIVE_EVAL_ERROR]: '⨂ ',\n  [RECEIVE_STDERR]: '⨂ ',\n  [RECEIVE_STDOUT]: '  '\n}\n\nexport function tab (state = 'sources', {type, payload}) {\n  if (type !== FOCUS_TAB) return state\n  return (payload + '').toLowerCase()\n}\n\nexport function panel (state = 'console', {type, payload}) {\n  if (type !== FOCUS_PANEL) return state\n  return payload\n}\n\nexport function sources (state = [], {type, payload}) {\n  if (type !== RECEIVE_SOURCES) return state\n  return payload\n}\n\nexport function files (state = [], {type, payload}) {\n  if (type !== RECEIVE_SOURCES) return state\n  const sources = payload.map(s => s.name)\n\n  const nonNative = sources.filter(s => s && s[0] === sep)\n    .reduce((o, path) => {\n      let next = o\n      path.split(sep).filter(Boolean).forEach((segment, ix, arr) => {\n        next[segment] = {value: {}}\n\n        if (ix === arr.length - 1) {\n          next[segment].data = {path}\n          next[segment].options = {terminate: true}\n        }\n        next = next[segment].value\n      })\n      return o\n    }, {})\n\n  const native = {\n    '(core)': {\n      value: sources\n        .filter(s => s && s[0] !== sep)\n        .reduce((o, f) => {\n          o[f] = {\n            value: {},\n            options: {terminate: true},\n            data: {path: f}\n          }\n          return o\n        }, {})\n    }\n  }\n\n  return {...native, ...nonNative}\n}\n\nexport function file (state = '', {type, payload}) {\n  if (type !== SELECT_FILE) return state\n  return payload\n}\n\nexport function fileItem (state = null, {type, payload = state}) {\n  if (type !== SET_FILE_ITEM) return state\n  return payload\n}\n\nexport function scopeItem (state = null, {type, payload = state}) {\n  if (type !== SET_SCOPE_ITEM) return state\n  return payload\n}\n\nexport function editorLine (state = 0, {type, payload}) {\n  if (type !== SET_EDITOR_LINE) return state\n  return payload\n}\n\nexport function callstack (state = [], {type, payload = []}) {\n  if (type !== RECEIVE_CALLSTACK) return state\n  return payload.map(({\n      functionName,\n      location: {lineNumber: l, columnNumber: c, url}\n    }) => (\n      (functionName || '(anonymous function)') + ' ' + basename(url) + ':' + l + ':' + c\n    )\n  )\n}\n\nexport function frames (state = [], {type, payload = []}) {\n  if (type !== RECEIVE_CALLSTACK) return state\n  return payload\n}\n\nexport function frame (state = {}, {type, payload}) {\n  if (type !== SELECT_FRAME) return state\n  return payload\n}\n\nexport function breaks (state = [], {type, payload}) {\n  if (type !== RECEIVE_BREAKPOINTS) return state\n  return payload\n}\n\nexport function breakpoints (state = [], {type, payload}) {\n  if (type !== RECEIVE_BREAKPOINTS) return state\n  return payload.map(({script_name: name, line}) => basename(name) + ':' + line)\n}\n\nexport function scope (state = {}, {type, payload: {area, scope, branch, namespace} = {}}) {\n  if (type === CLEAR_SCOPE) return {}\n\n  if (type === RECEIVE_SCOPE) {\n    return {\n      ...state,\n      [area]: {\n        options: {labelling: false},\n        value: treeify(scope)\n      }\n    }\n  }\n\n  if (type === EXTEND_SCOPE) {\n    // branch is still ref'd in state, altering the branch updates\n    // the state, but we want want to return a new state object to\n    // observe the rule of immutability. If this every breaks (due to branch\n    // being a copy instead of a direct ref, then we'd need to do a deep find\n    // on the state to locate the branch - along with that we'd need to add uids\n    // to every branch))\n    branch.value = treeify(scope)\n    return {...state}\n  }\n\n  if (type === ADD_ITEM_TO_SCOPE) {\n    state[area].value = {\n      [namespace]: Object(scope) === scope\n        ? {\n          label: 'Object',\n          value: !scope.length\n            ? {'« empty »': {options: {labelling: false}}}\n            : treeify(scope)\n        }\n        : {value: scope},\n      ...state[area].value\n    }\n\n    return {...state}\n  }\n\n  return state\n}\n\nexport function source (state = {}, {type, payload}) {\n  if (type !== RECEIVE_SOURCE) return state\n  return payload\n}\n\nexport function paused (state = false, {type}) {\n  if (type !== RESUME && type !== PAUSE) return state\n  return type === PAUSE\n}\n\nexport function layout (state = {}, {type, payload}) {\n  if (type !== SET_DIMENSIONS) return state\n  return payload\n}\n\nexport function tooltips (state = true, {type}) {\n  if (type !== TOGGLE_TOOLTIPS) return state\n  return !state\n}\n\nexport function output (state = {out: '', err: '', all: ''}, {type, payload}) {\n  console.log('type', type)\n  if (type === CONSOLE_HISTORY) {\n\n    if (!state.history && !state.history.length) {\n      return state\n    }\n\n    payload = payload || {step: -1}\n    const {step} = payload\n    let {historyIndex = 0} = state\n\n    historyIndex += step\n\n    if (historyIndex > 0) historyIndex = 0\n    if (-historyIndex > state.history.length) historyIndex = -(state.history.length)\n\n    return {\n      ...state,\n      historyIndex\n    }\n  }\n\n  if (type !== RECEIVE_STDOUT && type !== RECEIVE_STDERR &&\n    type !== CONSOLE_INPUT && type !== RECEIVE_EVAL_RESULT &&\n    type !== RECEIVE_EVAL_ERROR) return state\n\n  const {out, err, all, history = []} = state\n\n  const line = type === RECEIVE_EVAL_RESULT\n    ? CONSOLE_PREFIXES[type] + payload + '\\n'\n    : type === RECEIVE_EVAL_ERROR\n      ? '\\n' + CONSOLE_PREFIXES[type] + payload + '\\n'\n      : CONSOLE_PREFIXES[type] + payload\n\n  if (type === CONSOLE_INPUT) { \n    history.push((payload + '').trim())\n    state.historyIndex = 0\n  }\n\n  return {\n    ...state,\n    history,\n    out: (type === RECEIVE_STDOUT) ? CONSOLE_PREFIXES[type] + out + payload : out,\n    err: (type === RECEIVE_STDERR) ? CONSOLE_PREFIXES[type] + err + payload : err,\n    all: all + line\n  }\n}\n\n// utils:\n\nfunction treeify (scope) {\n  return scope.reduce((o, {name, type, value, text, source, className, properties, handle}) => {\n    if (type === 'object') { value = className }\n    if (className === 'Array') {\n      value = 'Array(' + properties.filter(({name}) => !isNaN(name)).length + ')'\n    }\n    if (type === 'string') {\n      value = '\\'' + value + '\\''\n    }\n    value = value || source || text\n    o[name] = properties\n      ? properties.length\n        ? {label: value, value: {}, meta: {handle}}\n        : {label: value, value: {'« empty »': {options: {labelling: false}}}}\n      : {value}\n\n    return o\n  }, {})\n}\n"]}