{"version":3,"sources":["../src/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import 'babel-polyfill'\nimport React from 'react'\nimport {Component} from 'react'\nimport blessed from 'blessed'\nimport {Provider, connect} from 'react-redux'\nimport {render} from 'react-blessed'\nimport functional from 'react-functional'\nimport portly from 'portly'\nimport createStore from './store/create'\nimport config from './config'\nimport { Console, Sources } from './containers'\nimport { Tabs } from './components'\nimport createDebugger from './lib/debug'\nimport {\n  focusTab,\n  focusPanel,\n  receiveCallstack,\n  receiveBreakpoints,\n  receiveScope,\n  receiveSource,\n  receiveSources,\n  selectFile,\n  pause,\n  resume,\n  stepOver,\n  stepInto,\n  stepOut,\n  nextFrame,\n  previousFrame\n} from './actions'\n\nconst store = createStore({\n  tab: 'sources',\n  panel: 'editor',\n  layout: config.layout,\n})\nconst {dispatch} = store\nconst tabs = ['Sources', 'Networking', 'Profiling', 'Console']\n\nlet Devtools = ({layout, tab}) => {\n  return (\n    <element>\n      <Tabs dispatch={dispatch} items={tabs} {...layout.tabs}/>\n      {tab === 'sources' && <Sources/>}\n      {tab === 'console' && <Console/>}\n    </element>\n  )\n}\n\nDevtools = connect(({layout, tab}) => ({layout, tab}))(Devtools)\n\nexport const debug = createDebugger()\n\nexport default async (pid) => {\n  const debugPort = 5858\n\n  if (pid) {\n    try { \n      process.kill(pid, 'SIGUSR1')\n    } catch (e) {\n      console.log('Warning unable to locate supplied pid ', pid)\n    }\n  }\n\n  const screen = blessed.screen({\n    autoPadding: true,\n    smartCSR: true,\n    title: 'Terminal Devtools',\n    sendFocus: true,\n    dockBorders: true,\n    autoPadding: true,\n    log: __dirname + '/log', //'/dev/ttys002',\n    ignoreLocked: ['C-c']\n  })\n\n  console.log = screen.log.bind(screen)\n  console.error = screen.log.bind(screen, 'ERROR: ')\n\n  dispatch(receiveSource('Waiting for port debug port ' + debugPort))\n  portly(debugPort).then(portPid => {\n    debug.start(debugPort, (err, callstack) => {\n      dispatch(receiveCallstack(callstack))\n\n      debug.scripts((err, scripts) => {\n        dispatch(receiveSources(scripts))\n        if (callstack) {\n          return dispatch(selectFile(callstack[0].location))\n        }\n        const {name} = (scripts.find(s => s.name[0] === '/') || scripts[0])\n        dispatch(selectFile(name))\n      })\n\n      debug.breakpoints((err, {breakpoints}) => {\n        if (err) { return console.error(err) }\n        receiveBreakpoints(breakpoints)\n      })\n    })\n  })\n\n\n  screen.key(['escape', 'q', 'C-c'], function(ch, key) {\n    return process.exit(0);\n  })\n\n\n  screen.key(['C-n'], () => dispatch(focusPanel('navigator')))\n  screen.key(['C-t'], () => dispatch(focusPanel('editor')))\n  screen.key(['C-s'], () => dispatch(focusPanel('callstack')))\n  screen.key(['C-p'], () => dispatch(focusPanel('breakpoints')))\n  screen.key(['C-o'], () => dispatch(focusPanel('scope')))\n  screen.key(['C-k'], () => dispatch(focusPanel('console')))\n\n  screen.key(['F8', 'C-\\\\', 'r'], () => dispatch(resume()))\n  screen.key(['S-F8', 'C-S-\\\\', 'p'], () => dispatch(pause()))\n  screen.key(['F10', 'C-\\'', 'n'], () => dispatch(stepOver()))\n\n  screen.key(['tab'], () => {\n    const {panel, tab} = store.getState()\n    const {ordering} = config.layout[tab]\n    let ix = ordering.indexOf(panel) + 1\n    if (ix >= ordering.length) ix = 0\n    dispatch(focusPanel(ordering[ix]))\n  })\n\n  screen.key(['S-tab'], () => {\n    const {panel, tab} = store.getState()\n    const {ordering} = config.layout[tab]\n    let ix = ordering.indexOf(panel) - 1\n    if (ix < 0) ix = ordering.length -1\n    dispatch(focusPanel(ordering[ix]))\n  })\n\n  return render(\n    <Provider store={store}>\n      <Devtools/>\n    </Provider>\n  , screen)\n\n}"]}