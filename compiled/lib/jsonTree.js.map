{"version":3,"sources":["../../src/lib/jsonTree.js"],"names":[],"mappings":"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","file":"jsonTree.js","sourcesContent":["/* eslint-disable */\n\n'use strict';\n\nvar _ = require('lodash');\nvar blessed = require('blessed');\n\n\nmodule.exports = function(screen, options, obj, name) {\n  var _obj = {};\n  var _list = blessed.list(options);\n  var _index;\n\n\n\n  var whitespace = function(depth) {\n    var ws = '';\n    for (var i = 0; i < depth; ++i) {\n      ws += '  ';\n    }\n    return ws;\n  };\n\n\n\n  var setMeta = function setMeta(obj, depth) {\n    _.each(_.keys(obj), function(key) {\n      if (_.isObject(obj[key])) {\n        setMeta(obj[key], depth + 1);\n        obj[key].meta = {expanded: false, depth: depth};\n      }\n    });\n  };\n\n\n\n  var clearIndex = function clearIndex(obj) {\n    _.each(_.keys(obj), function(key) {\n      if (_.isObject(obj[key])) {\n        if (obj[key].meta) {\n          obj[key].meta.index = null;\n        }\n        clearIndex(obj[key]);\n      }\n    });\n  };\n\n\n\n  var traverse = function traverse(obj, depth) {\n    var items = [];\n    var s;\n\n    _.each(_.keys(obj), function(key) {\n      if (_.isObject(obj[key])) {\n        if (key !== 'meta') {\n          if (obj[key].meta.expanded === true) {\n            s = whitespace(depth) + key + ' [-]';\n            items.push(s);\n            obj[key].meta.index = _index;\n            _index++;\n            items = _(items).concat(traverse(obj[key], depth + 1)).value();\n          }\n          else {\n            s = whitespace(depth) + key + ' [+]';\n            obj[key].meta.index = _index;\n            items.push(s);\n            _index++;\n          }\n          obj[key].meta.match = s;\n        }\n      }\n      else {\n        items.push(whitespace(depth) + key + ': ' + obj[key]);\n        _index++;\n      }\n    });\n    return items;\n  };\n\n\n  \n  var doSelect = function doSelect(obj, index) {\n    _.each(_.keys(obj), function(key) {\n      if (_.isObject(obj[key])) {\n        if (obj[key].meta && obj[key].meta.index && obj[key].meta.index === index) {\n          obj[key].meta.expanded = !obj[key].meta.expanded;\n        }\n        else {\n          doSelect(obj[key], index);\n        }\n      }\n    });\n  };\n\n\n\n  var render = function render() {\n    clearIndex(_obj);\n    _index = 0;\n    _list.setItems(traverse(_obj, 0));\n  };\n\n\n\n  var init = function init() {\n    _obj[name] = obj;\n    setMeta(_obj, 1);\n    _obj.meta = {expanded: true, depth: 0};\n    _obj[name].meta.expanded = true;\n    render();\n    _list.focus();\n\n    _list.on('select', function(line) {\n      debugger;\n      doSelect(_obj, _list.getItemIndex(line));\n      render();\n      _list.focus();\n      screen.render();\n    });\n  };\n\n\n\n  var get = function get() {\n    return _list;\n  };\n\n\n\n  init();\n  return {\n    get: get\n  };\n};\n\n"]}