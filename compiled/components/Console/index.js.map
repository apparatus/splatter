{"version":3,"sources":["../../../src/components/Console/index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import React from 'react'\nimport functional from 'react-functional'\nimport * as style from '../../style'\n\n/* eslint-disable react/no-unknown-property */\n\nconst Console = ({top, left, width, height, focused, independent, tooltips, output, actions}, cmp) => {\n  return (\n    <box\n      label='Console'\n      class={[style.panel, focused && style.selected]}\n      top={top}\n      left={left}\n      width={width}\n      height={height}\n      hoverText={actions && tooltips && 'ctrl+k'}\n    >\n      <textarea\n        ref={el => {\n          cmp.el = el\n          // hack :(\n          if (el && independent && focused) cmp.el.focus()\n        }}\n        mouse\n        inputOnFocus\n        focused={focused}\n        value={\n          !(cmp && cmp.force) ?\n            (output.all + '> ' + (\n              output.historyIndex ? \n                output.history.slice(output.historyIndex).shift() : \n                ''\n            )) : \n            cmp.force()\n        }\n        onFocus={() => (independent || focused || actions.focusPanel('console'))}\n        onBlur={()=> {\n          //blessed doesn't unfocus the textarea \n          //when mouse is used - work around:\n          const textarea = cmp.el.parent.children[1]\n          const screen = cmp.el.screen\n          textarea._reading = false\n          screen.grabKeys = false\n          screen.program.hideCursor()\n          textarea.removeListener('keypress')\n        }}\n        onKeyUp={() => {\n          actions.consoleHistory({step: -1})\n        }}\n        onKeyDown={() => {\n          actions.consoleHistory({step: 1})\n        }}\n        onKeyBackspace={(ch, key) => {\n          if (cmp.el.value.substr(-2) === '\\n>') {\n            const val = cmp.el.value\n            cmp.force = () => { cmp.force = null; return val + ' ' }\n            cmp.forceUpdate()\n          }\n        }}\n        onKeypress={(ch, key) => {\n          if (key.name === 'return' && !key.shift) {\n            const lines = cmp.el.getLines()\n            const cmd = (lines[lines.length - 2]+'').substr(2)\n            actions.consoleInput(cmd)\n            return\n          }\n\n          if (key.name === 'tab') {\n            cmp.el._done()\n            actions.focusPanel(key.shift ? 'scope' : 'navigator')\n\n            if (independent) {\n              actions.focusTab('sources')\n              actions.focusPanel('console')\n              return\n            }\n          }\n\n          if (independent) {\n            if (key.name === 'escape') {\n              // hack :( - avoids intermittent crashing\n              setTimeout(() => {\n                actions.focusTab('sources')\n                actions.focusPanel('console')\n              })\n            }\n            return\n          }\n        }}\n      />\n      {independent && (\n        <box\n          width={15}\n          right={0}\n          bottom={0}\n          height={1}\n        >\n          Exit: ESC, TAB\n        </box>\n      )}\n\n    </box>\n  )\n}\n\nexport default functional(Console)\n"]}